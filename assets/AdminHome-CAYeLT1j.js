import{_ as De,W as F,r as V,a as C,o as m,d as e,b as c,w as t,e as p,F as U,B as j,y as Ce,z as _,A as b,h as r,u as M,n as Ne,S as ke,D as xe,x as f,P as Ue,M as Me,R as Se,Q as Ae,X as Ye,I as S,V as R}from"./index-DBLKM03n.js";const Oe={class:"admin-home"},ze={class:"search-header"},Be={class:"search-actions"},Ie={class:"advanced-search"},Pe={class:"cert-list"},$e={class:"cert-header"},Ee={class:"cert-header-right"},Fe={class:"cert-info"},je={class:"cert-details"},Re={class:"cert-files"},qe={class:"cert-actions"},Le={class:"pagination"},Ge={class:"dialog-footer"},He={__name:"AdminHome",setup(Je){const n=F({companyName:"",certType:"",certName:"",patentType:"",softwareType:"",status:""}),d=F({issuingAuthority:"",certNumber:"",issueDate:[],applyDate:[],grantDate:[],patentNumber:"",registerDate:[],completeDate:[],registerNumber:""}),N=V(!1),B=V(1),I=V(10),Q=V(100),k=V(!1),T=V("add"),A=V(null),i=F({companyName:"",certType:"",title:"",issuingAuthority:"",certNumber:"",validityPeriod:[],level:"",scope:"",files:[]}),W={companyName:[{required:!0,message:"请选择企业名称",trigger:"change"}],certType:[{required:!0,message:"请选择资质类型",trigger:"change"}],title:[{required:!0,message:"请输入资质名称",trigger:"blur"}]},P=V([]),X=V([{id:1,title:"ISO9001质量管理体系认证",company:"示例科技有限公司",owner:"张三",uploadDate:"2024-03-15",status:"active",statusText:"已上架",certType:"基础资质",approver:"李四",issuingAuthority:"中国质量认证中心",certNumber:"ISO9001-2024-12345",issueDate:"2024-01-15",expiryDate:"2025-01-14",level:"A级",scope:"软件开发、系统集成",files:[{name:"ISO9001证书.pdf",size:"2.5MB",uploadTime:"2024-03-15 10:00:00"}]},{id:2,title:"CMMI5级认证",company:"测试企业有限公司",owner:"李四",uploadDate:"2024-03-16",status:"pending",statusText:"审批中",certType:"能力资质",approver:"-",issuingAuthority:"软件工程协会",certNumber:"CMMI-2024-54321",issueDate:"2024-02-01",expiryDate:"2025-02-01",level:"5级",scope:"软件开发过程管理",files:[{name:"CMMI证书.pdf",size:"1.8MB",uploadTime:"2024-03-16 14:30:00"}]},{id:3,title:"ISO27001信息安全管理体系认证",company:"安全科技有限公司",owner:"王五",uploadDate:"2024-03-10",status:"inactive",statusText:"已下架",certType:"基础资质",approver:"赵六",issuingAuthority:"信息安全认证中心",certNumber:"ISO27001-2024-67890",issueDate:"2024-01-20",expiryDate:"2025-01-19",level:"A级",scope:"信息安全管理",files:[{name:"ISO27001证书.pdf",size:"2.1MB",uploadTime:"2024-03-10 09:15:00"}]}]),K=o=>({active:"success",inactive:"info",pending:"warning",rejected:"danger",invalid:"danger"})[o]||"info",Z=o=>{o?P.value=[{value:"company1",label:"示例科技有限公司"},{value:"company2",label:"测试企业有限公司"}]:P.value=[]},Y=V([]),ee=[{value:"business_license",label:"营业执照"},{value:"operation_license",label:"运营许可"},{value:"tax_registration",label:"税务登记证"},{value:"organization_code",label:"组织机构代码证"}],le=[{value:"cmmi",label:"CMMI"},{value:"iso9001",label:"ISO9001"},{value:"iso27001",label:"ISO27001"},{value:"cyber_security",label:"网络安全等级保护"},{value:"high_tech",label:"高新技术企业"}],ae=()=>{n.certName="",n.patentType="",n.softwareType="",n.certType==="basic"?Y.value=ee:n.certType==="capability"?Y.value=le:Y.value=[],$()},$=()=>{Object.keys(d).forEach(o=>{Array.isArray(d[o])?d[o]=[]:d[o]=""})},te=o=>{N.value=o,o||$()},oe=()=>{const o={...n,...N.value?d:{}};console.log("搜索条件：",o)},ne=()=>{Object.keys(n).forEach(o=>{n[o]=""}),$(),Y.value=[],N.value=!1},ue=()=>{T.value="add",k.value=!0,Object.keys(i).forEach(o=>{i[o]=o==="files"?[]:""}),A.value&&A.value.clearValidate()},se=o=>{T.value="edit",k.value=!0,Object.keys(i).forEach(l=>{l in o&&(i[l]=o[l])})},de=o=>{if(o.status==="pending"||o.status==="invalid"){S.warning("当前状态不允许进行上下架操作");return}const l=o.status==="active"?"下架":"上架";R.confirm(`确定要${l}该资质吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{o.status=o.status==="active"?"inactive":"active",o.statusText=o.status==="active"?"已上架":"已下架",S.success(`${l}成功`)}).catch(()=>{})},re=o=>{if(o.status==="invalid"){S.warning("该资质已失效，无法再次删除");return}R.confirm("确定要删除该资质吗？删除后资质将变为失效状态，无法恢复。","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{o.status="invalid",o.statusText="已失效",S.success("资质已设置为失效状态")})},q=o=>{console.log("预览文件：",o)},ie=(o,l)=>{console.log("移除文件：",o)},pe=o=>R.confirm(`确定移除 ${o.name}？`),me=(o,l)=>{S.warning(`当前限制选择 5 个文件，本次选择了 ${o.length} 个文件，共选择了 ${o.length+l.length} 个文件`)},ce=async()=>{A.value&&await A.value.validate((o,l)=>{o?(console.log("提交表单：",i),S.success(T.value==="add"?"新增成功":"编辑成功"),k.value=!1):console.log("表单验证失败：",l)})},fe=o=>{I.value=o},ve=o=>{B.value=o};return(o,l)=>{const y=p("el-input"),u=p("el-form-item"),s=p("el-option"),D=p("el-select"),w=p("el-icon"),v=p("el-button"),_e=p("Refresh"),E=p("el-form"),be=p("el-switch"),h=p("el-col"),x=p("el-date-picker"),ye=p("el-row"),L=p("el-card"),G=p("el-tag"),g=p("el-descriptions-item"),H=p("el-descriptions"),O=p("el-table-column"),ge=p("el-table"),J=p("el-tooltip"),Ve=p("el-pagination"),he=p("el-alert"),Te=p("el-upload"),we=p("el-dialog");return m(),C("div",Oe,[e(L,{class:"search-section"},{default:t(()=>[c("div",ze,[e(E,{inline:!0,model:n,class:"search-form"},{default:t(()=>[e(u,{label:"企业名称"},{default:t(()=>[e(y,{modelValue:n.companyName,"onUpdate:modelValue":l[0]||(l[0]=a=>n.companyName=a),placeholder:"请输入企业名称"},null,8,["modelValue"])]),_:1}),e(u,{label:"资质类型"},{default:t(()=>[e(D,{modelValue:n.certType,"onUpdate:modelValue":l[1]||(l[1]=a=>n.certType=a),placeholder:"请选择资质类型",onChange:ae},{default:t(()=>[e(s,{label:"全部",value:""}),e(s,{label:"基础资质",value:"basic"}),e(s,{label:"能力资质",value:"capability"}),e(s,{label:"专利",value:"patent"}),e(s,{label:"软著",value:"software"})]),_:1},8,["modelValue"])]),_:1}),n.certType==="basic"||n.certType==="capability"?(m(),_(u,{key:0,label:"资质名称"},{default:t(()=>[e(D,{modelValue:n.certName,"onUpdate:modelValue":l[2]||(l[2]=a=>n.certName=a),placeholder:"请选择资质名称"},{default:t(()=>[(m(!0),C(U,null,j(Y.value,a=>(m(),_(s,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):b("",!0),n.certType==="patent"?(m(),_(u,{key:1,label:"专利类型"},{default:t(()=>[e(D,{modelValue:n.patentType,"onUpdate:modelValue":l[3]||(l[3]=a=>n.patentType=a),placeholder:"请选择专利类型"},{default:t(()=>[e(s,{label:"全部",value:""}),e(s,{label:"发明专利",value:"invention"}),e(s,{label:"实用新型专利",value:"utility"}),e(s,{label:"外观设计专利",value:"design"})]),_:1},8,["modelValue"])]),_:1})):b("",!0),n.certType==="software"?(m(),_(u,{key:2,label:"著作权类型"},{default:t(()=>[e(D,{modelValue:n.softwareType,"onUpdate:modelValue":l[4]||(l[4]=a=>n.softwareType=a),placeholder:"请选择著作权类型"},{default:t(()=>[e(s,{label:"全部",value:""}),e(s,{label:"原创软件著作权",value:"original"}),e(s,{label:"实用软件著作权",value:"practical"}),e(s,{label:"合作软件著作权",value:"cooperative"})]),_:1},8,["modelValue"])]),_:1})):b("",!0),e(u,{label:"状态"},{default:t(()=>[e(D,{modelValue:n.status,"onUpdate:modelValue":l[5]||(l[5]=a=>n.status=a),placeholder:"请选择状态"},{default:t(()=>[e(s,{label:"全部",value:""}),e(s,{label:"待审批",value:"pending"}),e(s,{label:"已上架",value:"active"}),e(s,{label:"已下架",value:"inactive"}),e(s,{label:"已驳回",value:"rejected"}),e(s,{label:"已失效",value:"invalid"})]),_:1},8,["modelValue"])]),_:1}),e(u,null,{default:t(()=>[e(v,{type:"primary",onClick:oe},{default:t(()=>[e(w,null,{default:t(()=>[e(M(Ne))]),_:1}),l[28]||(l[28]=r(" 搜索 "))]),_:1,__:[28]}),e(v,{onClick:ne},{default:t(()=>[e(w,null,{default:t(()=>[e(_e)]),_:1}),l[29]||(l[29]=r(" 重置 "))]),_:1,__:[29]})]),_:1})]),_:1},8,["model"]),c("div",Be,[e(be,{modelValue:N.value,"onUpdate:modelValue":l[6]||(l[6]=a=>N.value=a),"active-text":"高级搜索","inactive-text":"基础搜索",onChange:te},null,8,["modelValue"]),e(v,{type:"primary",onClick:ue},{default:t(()=>[e(w,null,{default:t(()=>[e(M(ke))]),_:1}),l[30]||(l[30]=r(" 新增资质 "))]),_:1,__:[30]})])]),Ce(c("div",Ie,[e(E,{model:d,"label-width":"100px"},{default:t(()=>[e(ye,{gutter:20},{default:t(()=>[n.certType==="basic"||n.certType==="capability"?(m(),C(U,{key:0},[e(h,{span:8},{default:t(()=>[e(u,{label:"发证机构"},{default:t(()=>[e(y,{modelValue:d.issuingAuthority,"onUpdate:modelValue":l[7]||(l[7]=a=>d.issuingAuthority=a),placeholder:"请输入发证机构"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,{span:8},{default:t(()=>[e(u,{label:"证书编号"},{default:t(()=>[e(y,{modelValue:d.certNumber,"onUpdate:modelValue":l[8]||(l[8]=a=>d.certNumber=a),placeholder:"请输入证书编号"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,{span:8},{default:t(()=>[e(u,{label:"发证日期"},{default:t(()=>[e(x,{modelValue:d.issueDate,"onUpdate:modelValue":l[9]||(l[9]=a=>d.issueDate=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1})],64)):b("",!0),n.certType==="patent"?(m(),C(U,{key:1},[e(h,{span:8},{default:t(()=>[e(u,{label:"申请日期"},{default:t(()=>[e(x,{modelValue:d.applyDate,"onUpdate:modelValue":l[10]||(l[10]=a=>d.applyDate=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,{span:8},{default:t(()=>[e(u,{label:"授权日期"},{default:t(()=>[e(x,{modelValue:d.grantDate,"onUpdate:modelValue":l[11]||(l[11]=a=>d.grantDate=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,{span:8},{default:t(()=>[e(u,{label:"专利号"},{default:t(()=>[e(y,{modelValue:d.patentNumber,"onUpdate:modelValue":l[12]||(l[12]=a=>d.patentNumber=a),placeholder:"请输入专利号"},null,8,["modelValue"])]),_:1})]),_:1})],64)):b("",!0),n.certType==="software"?(m(),C(U,{key:2},[e(h,{span:8},{default:t(()=>[e(u,{label:"登记日期"},{default:t(()=>[e(x,{modelValue:d.registerDate,"onUpdate:modelValue":l[13]||(l[13]=a=>d.registerDate=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,{span:8},{default:t(()=>[e(u,{label:"完成日期"},{default:t(()=>[e(x,{modelValue:d.completeDate,"onUpdate:modelValue":l[14]||(l[14]=a=>d.completeDate=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,{span:8},{default:t(()=>[e(u,{label:"登记号"},{default:t(()=>[e(y,{modelValue:d.registerNumber,"onUpdate:modelValue":l[15]||(l[15]=a=>d.registerNumber=a),placeholder:"请输入登记号"},null,8,["modelValue"])]),_:1})]),_:1})],64)):b("",!0)]),_:1})]),_:1},8,["model"])],512),[[xe,N.value]])]),_:1}),c("div",Pe,[(m(!0),C(U,null,j(X.value,a=>(m(),_(L,{key:a.id,class:"cert-card"},{header:t(()=>[c("div",$e,[c("h3",null,f(a.title),1),c("div",Ee,[e(G,{type:K(a.status)},{default:t(()=>[r(f(a.statusText),1)]),_:2},1032,["type"]),e(G,{type:"info",class:"ml-2"},{default:t(()=>[r(f(a.certType),1)]),_:2},1024)])])]),default:t(()=>[c("div",Fe,[e(H,{column:4,border:""},{default:t(()=>[e(g,{label:"所属公司"},{default:t(()=>[r(f(a.company),1)]),_:2},1024),e(g,{label:"负责人"},{default:t(()=>[r(f(a.owner),1)]),_:2},1024),e(g,{label:"上传日期"},{default:t(()=>[r(f(a.uploadDate),1)]),_:2},1024),e(g,{label:"审批人"},{default:t(()=>[r(f(a.approver||"-"),1)]),_:2},1024)]),_:2},1024)]),c("div",je,[e(H,{title:"证书信息",column:3,border:""},{default:t(()=>[e(g,{label:"发证机构"},{default:t(()=>[r(f(a.issuingAuthority),1)]),_:2},1024),e(g,{label:"证书编号"},{default:t(()=>[r(f(a.certNumber),1)]),_:2},1024),e(g,{label:"发证日期"},{default:t(()=>[r(f(a.issueDate),1)]),_:2},1024),e(g,{label:"有效期至"},{default:t(()=>[r(f(a.expiryDate),1)]),_:2},1024),e(g,{label:"资质等级"},{default:t(()=>[r(f(a.level),1)]),_:2},1024),e(g,{label:"认证范围"},{default:t(()=>[r(f(a.scope),1)]),_:2},1024)]),_:2},1024)]),c("div",Re,[l[32]||(l[32]=c("h4",null,"附件列表",-1)),e(ge,{data:a.files,style:{width:"100%"}},{default:t(()=>[e(O,{prop:"name",label:"文件名"}),e(O,{prop:"size",label:"大小",width:"120"}),e(O,{prop:"uploadTime",label:"上传时间",width:"180"}),e(O,{label:"操作",width:"120"},{default:t(({row:z})=>[e(v,{link:"",type:"primary",onClick:Qe=>q(z)},{default:t(()=>l[31]||(l[31]=[r("预览")])),_:2,__:[31]},1032,["onClick"])]),_:1})]),_:2},1032,["data"])]),c("div",qe,[e(v,{type:"primary",onClick:z=>se(a)},{default:t(()=>[e(w,null,{default:t(()=>[e(M(Ue))]),_:1}),l[33]||(l[33]=r(" 编辑 "))]),_:2,__:[33]},1032,["onClick"]),a.status!=="pending"&&a.status!=="invalid"?(m(),_(v,{key:0,type:a.status==="active"?"warning":"success",onClick:z=>de(a)},{default:t(()=>[e(w,null,{default:t(()=>[(m(),_(Me(a.status==="active"?"ArrowDown":"ArrowUp")))]),_:2},1024),r(" "+f(a.status==="active"?"下架":"上架"),1)]),_:2},1032,["type","onClick"])):b("",!0),a.status!=="invalid"?(m(),_(v,{key:1,type:"danger",onClick:z=>re(a)},{default:t(()=>[e(w,null,{default:t(()=>[e(M(Se))]),_:1}),l[34]||(l[34]=r(" 删除 "))]),_:2,__:[34]},1032,["onClick"])):b("",!0),a.status==="pending"?(m(),_(J,{key:2,content:"审批中的资质不能进行上下架操作",placement:"top"},{default:t(()=>[e(v,{disabled:""},{default:t(()=>[e(w,null,{default:t(()=>[e(M(Ae))]),_:1}),l[35]||(l[35]=r(" 审批中 "))]),_:1,__:[35]})]),_:1})):b("",!0),a.status==="invalid"?(m(),_(J,{key:3,content:"该资质已失效",placement:"top"},{default:t(()=>[e(v,{disabled:"",type:"danger"},{default:t(()=>[e(w,null,{default:t(()=>[e(M(Ye))]),_:1}),l[36]||(l[36]=r(" 已失效 "))]),_:1,__:[36]})]),_:1})):b("",!0)])]),_:2},1024))),128))]),c("div",Le,[e(Ve,{"current-page":B.value,"onUpdate:currentPage":l[16]||(l[16]=a=>B.value=a),"page-size":I.value,"onUpdate:pageSize":l[17]||(l[17]=a=>I.value=a),total:Q.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:fe,onCurrentChange:ve},null,8,["current-page","page-size","total"])]),e(we,{modelValue:k.value,"onUpdate:modelValue":l[27]||(l[27]=a=>k.value=a),title:T.value==="add"?"新增资质":"编辑资质",width:"60%"},{footer:t(()=>[c("span",Ge,[e(v,{onClick:l[26]||(l[26]=a=>k.value=!1)},{default:t(()=>l[39]||(l[39]=[r("取消")])),_:1,__:[39]}),e(v,{type:"primary",onClick:ce},{default:t(()=>l[40]||(l[40]=[r("确定")])),_:1,__:[40]})])]),default:t(()=>[T.value==="edit"?(m(),_(he,{key:0,title:"编辑提示",description:"企业名称、资质类型、资质名称在编辑模式下不允许修改",type:"info",closable:!1,"show-icon":"",style:{"margin-bottom":"20px"}})):b("",!0),e(E,{model:i,"label-width":"100px",rules:W,ref_key:"certFormRef",ref:A},{default:t(()=>[e(u,{label:"企业名称",prop:"companyName"},{default:t(()=>[e(D,{modelValue:i.companyName,"onUpdate:modelValue":l[18]||(l[18]=a=>i.companyName=a),filterable:"",remote:"","remote-method":Z,disabled:T.value==="edit",placeholder:"请选择或输入企业名称"},{default:t(()=>[(m(!0),C(U,null,j(P.value,a=>(m(),_(s,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),e(u,{label:"资质类型",prop:"certType"},{default:t(()=>[e(D,{modelValue:i.certType,"onUpdate:modelValue":l[19]||(l[19]=a=>i.certType=a),disabled:T.value==="edit",placeholder:"请选择资质类型"},{default:t(()=>[e(s,{label:"基础资质",value:"basic"}),e(s,{label:"能力资质",value:"capability"}),e(s,{label:"专利",value:"patent"}),e(s,{label:"软著",value:"software"})]),_:1},8,["modelValue","disabled"])]),_:1}),e(u,{label:"资质名称",prop:"title"},{default:t(()=>[e(y,{modelValue:i.title,"onUpdate:modelValue":l[20]||(l[20]=a=>i.title=a),disabled:T.value==="edit",placeholder:"请输入资质名称"},null,8,["modelValue","disabled"])]),_:1}),e(u,{label:"发证机构"},{default:t(()=>[e(y,{modelValue:i.issuingAuthority,"onUpdate:modelValue":l[21]||(l[21]=a=>i.issuingAuthority=a),placeholder:"请输入发证机构"},null,8,["modelValue"])]),_:1}),e(u,{label:"证书编号"},{default:t(()=>[e(y,{modelValue:i.certNumber,"onUpdate:modelValue":l[22]||(l[22]=a=>i.certNumber=a),placeholder:"请输入证书编号"},null,8,["modelValue"])]),_:1}),e(u,{label:"有效期"},{default:t(()=>[e(x,{modelValue:i.validityPeriod,"onUpdate:modelValue":l[23]||(l[23]=a=>i.validityPeriod=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),e(u,{label:"资质等级"},{default:t(()=>[e(y,{modelValue:i.level,"onUpdate:modelValue":l[24]||(l[24]=a=>i.level=a),placeholder:"请输入资质等级"},null,8,["modelValue"])]),_:1}),e(u,{label:"认证范围"},{default:t(()=>[e(y,{modelValue:i.scope,"onUpdate:modelValue":l[25]||(l[25]=a=>i.scope=a),type:"textarea",rows:3,placeholder:"请输入认证范围"},null,8,["modelValue"])]),_:1}),e(u,{label:"资质附件"},{default:t(()=>[e(Te,{class:"upload-demo",action:"/api/upload","on-preview":q,"on-remove":ie,"before-remove":pe,multiple:"",limit:5,"on-exceed":me,"file-list":i.files},{tip:t(()=>l[38]||(l[38]=[c("div",{class:"el-upload__tip"}," 支持 PDF、JPG、PNG 格式，单个文件不超过 10MB ",-1)])),default:t(()=>[e(v,{type:"primary"},{default:t(()=>l[37]||(l[37]=[r("点击上传")])),_:1,__:[37]})]),_:1},8,["file-list"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},Xe=De(He,[["__scopeId","data-v-083e2b95"]]);export{Xe as default};
